<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-translate-customization" content="108d9124921d80c3-80e20d618ff053c8-g4f02ec6f3dba68b7-c">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>[TypeScript] 타입 단언과 가드 | IT 데이터베이스</title>
<meta name="generator" content="Jekyll v4.2.2">
<meta property="og:title" content="[TypeScript] 타입 단언과 가드">
<meta name="author" content="GitHub User">
<meta property="og:locale" content="en_US">
<meta name="description" content="타입 단언 타입 스크립트는 타입 표기, 가드, 추론 등의 기법으로 값의 타입을 판단한다. 하지만 떄론 컴파일러의 정보를 무시하고 개발자가 원하는 임의의 타입을 할당하고 싶을 수 있다. 이럴 때 사용하는 것이 타입 단언(type assertion)이다.">
<meta property="og:description" content="타입 단언 타입 스크립트는 타입 표기, 가드, 추론 등의 기법으로 값의 타입을 판단한다. 하지만 떄론 컴파일러의 정보를 무시하고 개발자가 원하는 임의의 타입을 할당하고 싶을 수 있다. 이럴 때 사용하는 것이 타입 단언(type assertion)이다.">
<link rel="canonical" href="http://localhost:4000/typescirpt/2022/07/29/typescript-06.html">
<meta property="og:url" content="http://localhost:4000/typescirpt/2022/07/29/typescript-06.html">
<meta property="og:site_name" content="IT 데이터베이스">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2022-07-29T00:00:00+09:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="[TypeScript] 타입 단언과 가드">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"GitHub User"},"dateModified":"2022-07-29T00:00:00+09:00","datePublished":"2022-07-29T00:00:00+09:00","description":"타입 단언 타입 스크립트는 타입 표기, 가드, 추론 등의 기법으로 값의 타입을 판단한다. 하지만 떄론 컴파일러의 정보를 무시하고 개발자가 원하는 임의의 타입을 할당하고 싶을 수 있다. 이럴 때 사용하는 것이 타입 단언(type assertion)이다.","headline":"[TypeScript] 타입 단언과 가드","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/typescirpt/2022/07/29/typescript-06.html"},"url":"http://localhost:4000/typescirpt/2022/07/29/typescript-06.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="shortcut icon" href="">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-noto-sans@0.0.72/index.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/image-popup.css">

  <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="/assets/js/main.js"></script>
  <script src="/assets/js/zooming.min.js"></script><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="IT 데이터베이스">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
<!-- and it's easy to individually load additional languages -->
<script charset="UTF-8" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/go.min.js"></script>



















<script>
// Init highlight js
document.addEventListener('DOMContentLoaded', function(event) {
  var els = document.querySelectorAll('pre code')

  function addLangData(block) {
    var outer = block.parentElement.parentElement.parentElement;
    var lang = block.getAttribute('data-lang');
    for (var i = 0; i < outer.classList.length; i++) {
      var cls = outer.classList[i];
      if (cls.startsWith('language-')) {
        lang = cls;
        break;
      }
    }
    if (!lang) {
      cls = block.getAttribute('class');
      lang = cls ? cls.replace('hljs ', '') : '';
    }
    if (lang.startsWith('language-')) {
      lang = lang.substr(9);
    }
    block.setAttribute('class', 'hljs ' + lang);
    block.parentNode.setAttribute('data-lang', lang);
  }

  function addBadge(block) {
    var enabled = ('true' || 'true').toLowerCase();
    if (enabled == 'true') {
      var pre = block.parentElement;
      pre.classList.add('badge');
    }
  }

  function handle(block) {
    addLangData(block);
    addBadge(block)
    hljs.highlightBlock(block);
  }

  for (var i = 0; i < els.length; i++) {
    var el = els[i];
    handle(el);
  }
});
</script>

<style>
  /* code language badge */
  pre.badge::before {
    content: attr(data-lang);
    color: #fff;
    background-color: #ff4e00;
    padding: 0 .5em;
    border-radius: 0 2px;
    text-transform: uppercase;
    text-align: center;
    min-width: 32px;
    display: inline-block;
    position: absolute;
    right: 0;
  }

  /* fix wrong badge display for firefox browser */
  code > table pre::before {
    display: none;
  }
</style>
</head>
<body>





































































































































<header class="site-header site-header-transparent" role="banner">

  <div class="wrapper">
    <div class="site-header-inner">
<span class="site-brand"><a class="site-brand-inner" rel="author" href="/">
  <img class="site-favicon" title="IT 데이터베이스" src="" onerror="this.style.display='none'">
  IT 데이터베이스
</a>
</span><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger">
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewbox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
              </svg>
            </span>
          </label>

          <div class="trigger">
<a class="page-link" href="/about.html">ABOUT</a><a class="page-link" href="/archives.html">ARCHIVES</a><a class="page-link" href="/categories.html">CATEGORIES</a><a class="page-link" href="/">HOME</a><a class="page-link" href="/tags.html">TAGS</a>









<span class="page-link">



<div id="google_translate_element" style="display: none;">
</div>

<span class="ct-language">
  <ul class="list-unstyled ct-language-dropdown">
    
      <li>
        <a href="#" class="lang-select" data-lang="en">
          
          <img src="https://cdn.countryflags.com/thumbs/united-states-of-america/flag-400.png" title="English">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="fr">
          
          <img src="https://cdn.countryflags.com/thumbs/france/flag-400.png" title="French">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="zh-CN">
          
          <img src="https://cdn.countryflags.com/thumbs/china/flag-400.png" title="Chinese(Simple)">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ja">
          
          <img src="https://cdn.countryflags.com/thumbs/japan/flag-400.png" title="Japanese">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ko">
          
          <img src="https://cdn.countryflags.com/thumbs/south-korea/flag-400.png" title="Korean">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ru">
          
          <img src="https://cdn.countryflags.com/thumbs/russia/flag-400.png" title="Russian">
          
        </a>
      </li>
    
  </ul>
</span>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: 'en',
    autoDisplay: false,
    layout: google.translate.TranslateElement.InlineLayout.VERTICAL
  }, 'google_translate_element');

  // Links to cross-origin destinations are unsafe
  var gll = document.getElementsByClassName('goog-logo-link')[0];
  if (gll) {
    gll.setAttribute('rel', 'noopener');
  }

  function restoreLang() {
    var iframe = document.getElementsByClassName('goog-te-banner-frame')[0];
    if (!iframe) return;

    var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
    var restore_el = innerDoc.getElementsByTagName("button");

    for (var i = 0; i < restore_el.length; i++) {
      if (restore_el[i].id.indexOf("restore") >= 0) {
        restore_el[i].click();
        var close_el = innerDoc.getElementsByClassName("goog-close-link");
        close_el[0].click();
        return;
      }
    }
  }

  function triggerHtmlEvent(element, eventName) {
    var event;
    if (document.createEvent) {
      event = document.createEvent('HTMLEvents');
      event.initEvent(eventName, true, true);
      element.dispatchEvent(event);
    } else {
      event = document.createEventObject();
      event.eventType = eventName;
      element.fireEvent('on' + event.eventType, event);
    }
  }

  var googleCombo = document.querySelector("select.goog-te-combo");
  var langSelect = document.querySelector('.ct-language');
  langSelect.addEventListener('click', function(event) {
    if (!event.target) {
      return;
    }

    var selected = document.querySelector('.ct-language .ct-language-selected');
    if (selected) {
      selected.classList.remove('ct-language-selected');
    }

    var target = event.target;
    while (target && target !== langSelect ) {
      if (target.matches('.lang-select')) {
        break;
      }
      target = target.parentElement;
    }

    if (target && target.matches('.lang-select')) {
      var lang = target.getAttribute('data-lang');
      if (googleCombo.value == lang) {
        restoreLang();
      } else {
        target.parentElement.classList.add('ct-language-selected');
        googleCombo.value = lang;
        triggerHtmlEvent(googleCombo, 'change');
      }
    }

    event.preventDefault();
  });
}
</script>

<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</span>
</div>
        </nav>
</div>
  </div>
</header>

<script>
  function initHeader() {
    var lastScrollY = getScrollPos().y;
    var documentElement = document.documentElement;

    function storeScrollData() {
      var y = getScrollPos().y;documentElement.setAttribute("data-header-transparent", "");var scrollStatus = "";

      if (y <= 0) {
        scrollStatus = "top";
      } else if ((window.innerHeight + y) >= document.body.offsetHeight) {
        scrollStatus = "bottom";
      } else {
        var isScrollDown = (y - lastScrollY > 0) ? true : false;
        scrollStatus = isScrollDown ? "down" : "up";
      }

      lastScrollY = y;
      documentElement.setAttribute("data-scroll-status", scrollStatus);
    }

    window.addEventListener('scroll', function(e) {
      storeScrollData();
    });

    storeScrollData();
  }
  document.addEventListener('DOMContentLoaded', initHeader);
</script>


























































































































































<style>
    html .page-banner {
      background: #000;
    }
  </style>
<style>html .page-banner {
      height:  36.8vh;
      min-height: 38vh;
    }
    html[data-scroll-status="top"] .page-banner {
      height: 100vh;
    }
  </style>
<style>
    html .page-banner .page-banner-img > *:first-child {
      opacity: 0.618;
    }

    html[data-theme="dark"] .page-banner .page-banner-img > *:first-child {
      opacity: 0.443724;
    }
  </style>
<style>
    html .page-banner .page-banner-inner > *:first-child > *:nth-child(1) {
      font-size: 3.25em; font-weight: bold; text-decoration: underline
    }
  </style>
<style>
    html .page-banner .page-banner-inner > *:first-child > *:nth-child(2) {
      color: gold
    }
  </style>
<section class="page-banner">
    <div class="page-banner-img">
<div style="background-image: url(/assets/images/banners/typescript.jpeg)"></div>
        <img class="img-placeholder" src="/assets/images/banners/typescript.jpeg">
</div>
    <div class="wrapper">
      <div class="page-banner-inner">
<header class="post-header">
  <h1 class="post-title p-name" itemprop="name headline">[TypeScript] 타입 단언과 가드</h1>
  <h2 class="post-subtitle"></h2>

  <p class="post-meta">
    <time class="dt-published" datetime="2022-07-29T00:00:00+09:00" itemprop="datePublished"><i class="fa fa-calendar"></i> Jul 29, 2022
    </time>

    
    
































    <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 10 mins</span>
  </p>
<div class="post-tags">
<a class="post-tag" href="/tags.html#Typescirpt">#Typescirpt</a><a class="post-tag" href="/tags.html#Javascript">#Javascript</a><a class="post-tag" href="/tags.html#ES6">#ES6</a>
</div></header>
</div>
    </div>
  </section><script>
  function hashLocate(hashValue) {
    hashValue = hashValue.replace(/^.*#h-/, '');
    hashValue = decodeURIComponent(hashValue);
    var element = document.getElementById(hashValue);

    if (!element) {
      return;
    }

    var header = document.querySelector('header.site-header');
    var headerRect = header.getBoundingClientRect();
    var headerTop = Math.floor(headerRect.top);
    var headerHeight = Math.floor(headerRect.height);
    var scrollPos = getScrollPos();
    var offsetY = element.offsetTop - (headerTop + headerHeight + 20);

    if (offsetY == scrollPos.y) {
      return;
    }

    if (headerTop == 0  && offsetY > scrollPos.y) {
      offsetY += headerHeight + 2;
    } else if (headerTop < 0  && offsetY < scrollPos.y) {
      offsetY -= headerHeight - 2;
    }

    smoothScrollTo(offsetY);
  }

  // The first event occurred
  window.addEventListener('load', function(event) {
    if (window.location.hash) {
      hashLocate(window.location.hash);
    }
  });

  // The first event occurred
  window.addEventListener('click', function(event) {
    if (event.target.tagName.toLowerCase() == 'a') {
      hashLocate(event.target.getAttribute('href'));
    }
  });
</script>
<div class="theme-toggle">
  <input type="checkbox" id="theme-switch">
  <label for="theme-switch">
    <div class="toggle"></div>
    <div class="names">
      <p class="light">Light</p>
      <p class="dark">Dark</p>
    </div>
  </label>
</div>




<script>
  (function() {
    var sw = document.getElementById('theme-switch');
    var html = document.getElementsByTagName('html')[0];
    var nightModeOption = ('auto' || 'auto').toLowerCase();
    var storage = nightModeOption === 'manual'
        ? localStorage
        : sessionStorage;
    var themeData = loadThemeData();

    function saveThemeData(data) {
      storage.setItem('theme', JSON.stringify(data));
    }

    function loadThemeData() {
      var data = storage.getItem('theme');
      try {
        data = JSON.parse(data ? data : '');
      } catch(e) {
        data = { nightShift: undefined, autoToggleAt: 0 };
        saveThemeData(data);
      }
      return data;
    }

    function handleThemeToggle(nightShift) {
      themeData.nightShift = nightShift;
      saveThemeData(themeData);
      html.dataset.theme = nightShift ? 'dark' : 'light';
      setTimeout(function() {
        sw.checked = nightShift ? true : false;
      }, 50);
    }

    function autoThemeToggle() {
      // Next time point of theme toggle
      var now = new Date();
      var toggleAt = new Date();
      var hours = now.getHours();
      var nightShift = hours >= 19 || hours <=7;

      if (nightShift) {
        if (hours > 7) {
          toggleAt.setDate(toggleAt.getDate() + 1);
        }
        toggleAt.setHours(7);
      } else {
        toggleAt.setHours(19);
      }

      toggleAt.setMinutes(0);
      toggleAt.setSeconds(0);
      toggleAt.setMilliseconds(0)

      var delay = toggleAt.getTime() - now.getTime();

      // auto toggle theme mode
      setTimeout(function() {
        handleThemeToggle(!nightShift);
      }, delay);

      return {
        nightShift: nightShift,
        toggleAt: toggleAt.getTime()
      };
    }

    // Listen the theme toggle event
    sw.addEventListener('change', function(event) {
      handleThemeToggle(event.target.checked);
    });

    if (nightModeOption == 'auto') {
      var data = autoThemeToggle();

      // Toggle theme by local setting
      if (data.toggleAt > themeData.autoToggleAt) {
        themeData.autoToggleAt = data.toggleAt;
        handleThemeToggle(data.nightShift);
      } else {
        handleThemeToggle(themeData.nightShift);
      }
    } else if (nightModeOption == 'manual') {
      handleThemeToggle(themeData.nightShift);
    } else {
      var nightShift = themeData.nightShift;
      if (nightShift === undefined) {
        nightShift = nightModeOption === 'on';
      }
      handleThemeToggle(nightShift);
    }
  })();
</script>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="framework">
  <section class="main">

     <div class="post">
  <section>









<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

    <div class="post-content e-content" itemprop="articleBody">

      <h2 id="타입-단언">타입 단언</h2>
<p>타입 스크립트는 타입 표기, 가드, 추론 등의 기법으로 값의 타입을 판단한다. 하지만 떄론 컴파일러의 정보를 무시하고 개발자가 원하는 임의의 타입을 할당하고 싶을 수 있다. 이럴 때 사용하는 것이 타입 단언<code class="language-plaintext highlighter-rouge">(type assertion)</code>이다.</p>

<h3 id="타입-단언을-사용하는-이유">타입 단언을 사용하는 이유</h3>
<p>a에 10이라는 값을 할당하면 타입스크립트는 알아서 <code class="language-plaintext highlighter-rouge">number</code> 타입으로 추론하게 된다. 따라서, 변수 b에 a를 할당하면 b역시 <code class="language-plaintext highlighter-rouge">number</code>타입을 갖게 되는 것이다.</p>

<p><img src="https://user-images.githubusercontent.com/52439201/182020229-7b78b6b5-2d43-42d6-b330-131a5d8d9048.png" alt="image"></p>

<p>하지만, a를 최초 선언 당시 아무 값도 할당하지 않았으므로, 타입스크립트는 a를 <code class="language-plaintext highlighter-rouge">any</code> 타입으로 추론하게 된다. 따라서, b역시 <code class="language-plaintext highlighter-rouge">any</code> 타입으로 추론하는 것이다.</p>

<p><img src="https://user-images.githubusercontent.com/52439201/182020287-c415291f-6d68-4805-bd38-7ccb03b68709.png" alt="image"></p>

<p>하지만, 개발자들은 마지막 ‘abc’를 할당했으므로 <code class="language-plaintext highlighter-rouge">string</code> 타입을 기대했을 것이다. 이럴 때 사용하는 것이 바로 <code class="language-plaintext highlighter-rouge">타입 단언(type assertion)</code>이다 타입스크립트보다 개발자가 그 타입에 대해 정확하게 알고 있을 때 사용한다고 생각하면 된다. <code class="language-plaintext highlighter-rouge">value as Type</code> 문법을 사용해서 value를 type으로 단언할 수 있다.</p>

<p><img src="https://user-images.githubusercontent.com/52439201/182020463-9a58e7dd-42e2-4efd-bae7-46fcf0e7f590.png" alt="image"></p>

<h3 id="주의할-점">주의할 점</h3>
<p>타입 단언은 타입 에러를 없애줄 분 런타임 에러를 막아주지 못한다. 오히려 그 반대인데, 컴파일타입에서 잡을 수 있는 에러를 없앰으로서 원래대로라면 발생하지 않을 런타임 에러를 발생시킬 수 있다. 아래의 코드를 보자.</p>

<p><img src="https://user-images.githubusercontent.com/52439201/182020799-e43aecf6-5547-48d2-9ac9-172201af1948.png" alt="image"></p>

<p>유니온 타입은 공통타입이 아닌 타입에 대해서는 에러를 발생시킨다. <code class="language-plaintext highlighter-rouge">weight</code>속성은 dog 타입에만 존재하므로 dog 타입으로 단언하면 타입에러를 없앨 수 있다.</p>

<p><img src="https://user-images.githubusercontent.com/52439201/182020877-347ecd31-d4f9-42cb-8969-214ce2b50c12.png" alt="image"></p>

<p>하지만, 아래와 같이 예상되지 않는 타입의 값이 들어가면 에러가 발생한다.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">interface</span> <span class="nx">dog</span> <span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nx">weight</span><span class="p">():</span> <span class="k">void</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">cats</span> <span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
  <span class="nl">age</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">test</span> <span class="p">(</span><span class="nx">info</span><span class="p">:</span> <span class="nx">dog</span> <span class="o">|</span> <span class="nx">cats</span><span class="p">){</span>
  <span class="k">return</span> <span class="p">(</span><span class="nx">info</span> <span class="k">as</span> <span class="nx">dog</span><span class="p">).</span><span class="nx">weight</span><span class="p">();</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">info</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">siksik</span><span class="dl">'</span><span class="p">,</span>
  <span class="na">age</span><span class="p">:</span> <span class="mi">10</span>
<span class="p">}</span>

<span class="nx">test</span><span class="p">(</span><span class="nx">info</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/52439201/182021207-d121941e-15ca-4532-a6d3-fb7ef54faf5e.png" alt="image"></p>

<p><br></p>

<h2 id="타입-가드">타입 가드</h2>
<p>특정 스코프 내에서 값의 타입을 좁혀나가는 것을 타입 가드라 한다.</p>

<p>타입 가드는 크게 두 종류로 나뉜다.</p>
<ul>
  <li>제어 흐름 분석(control flow analysis)</li>
  <li>사용자 정의 타입 가드(user defined type guard)</li>
</ul>

<h3 id="제어-흐름-분석control-flow-analysis">제어 흐름 분석(control flow analysis)</h3>
<p>기본적으로 자바스크립트는 비동기 실행 코드를 제외하고는 전부 위에서부터 아래로 순차적으로 코드가 실행된다. 대부분의 프로그래밍 언어는 특정 조건이 만족될 때에만 코드를 실행하거나 같은 코들르 여러번 실행하는 식으로 순차적 실행을 벗어난 실행을 가능하게 하는 <code class="language-plaintext highlighter-rouge">제어 구조(control structure)</code>를 제공한다.</p>

<p>자바스크립트와 타입스크립트 또한 제어 구조를 제공한다. 대표적인 제어 구조는 아래와 같다.</p>
<ul>
  <li>if, else if, else</li>
  <li>while, for</li>
  <li>switch, case</li>
  <li>break, continue</li>
  <li>return</li>
</ul>

<p>컴파일러는 위의 제어 구조로부터 특정 시점에서의 상태 정보를 얻는다. 그리고 컴파일러는 이러한 정보를 이용해 <code class="language-plaintext highlighter-rouge">제어 흐름 분석</code>을 진행하여 특정 값의 타입을 좁혀낼 수 있다.
그렇다면, 제어 흐름 분석으로 어떻게 타입을 좁히는지 알아보자.</p>

<h3 id="undefined--null-비교">undefined / null 비교</h3>
<p>undefined 또는 null 과의 비교로 각각 대응하는 타입에 대한 타입 가드로 동작한다.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">interface</span> <span class="nx">info</span> <span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="kr">string</span> <span class="o">|</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">person</span><span class="p">(</span><span class="nx">info</span><span class="p">:</span> <span class="nx">info</span><span class="p">){</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">info</span><span class="p">.</span><span class="nx">name</span> <span class="o">===</span> <span class="kc">null</span><span class="p">){</span>
    <span class="k">return</span> <span class="dl">'</span><span class="s1">null</span><span class="dl">'</span>
  <span class="p">}</span><span class="k">else</span> <span class="p">{</span>
    <span class="c1">// info.name 타입은 string</span>
    <span class="k">return</span> <span class="nx">info</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="리터럴-타입-비교">리터럴 타입 비교</h3>
<p>리터럴 타입과의 비교도 타입 가드로 동작한다.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">interface</span> <span class="nx">Human</span> <span class="p">{</span>
  <span class="nl">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">human</span><span class="dl">'</span><span class="p">;</span>
  <span class="nl">sex</span><span class="p">:</span> <span class="dl">'</span><span class="s1">man</span><span class="dl">'</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">Animal</span> <span class="p">{</span>
  <span class="nl">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">animal</span><span class="dl">'</span><span class="p">;</span>
  <span class="nl">name</span><span class="p">:</span> <span class="dl">'</span><span class="s1">dog</span><span class="dl">'</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">something</span><span class="p">(</span><span class="nx">data</span><span class="p">:</span> <span class="nx">Human</span> <span class="o">|</span> <span class="nx">Animal</span><span class="p">){</span>
  <span class="k">switch</span> <span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="kd">type</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">case</span> <span class="dl">'</span><span class="s1">human</span><span class="dl">'</span><span class="p">:</span> <span class="p">{</span>
      <span class="c1">// data는 Human 타입</span>
      <span class="k">return</span> <span class="nx">data</span><span class="p">.</span><span class="nx">sex</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">case</span> <span class="dl">'</span><span class="s1">animal</span><span class="dl">'</span><span class="p">:</span> <span class="p">{</span>
      <span class="c1">// data는 Animal 타입</span>
      <span class="k">return</span> <span class="nx">data</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nl">default</span><span class="p">:</span> <span class="p">{</span>
      <span class="c1">// data는 null 타입</span>
      <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>공통 리터럴 타입인 <code class="language-plaintext highlighter-rouge">type</code>을 기반으로 switch-case를 통해 각 브랜치에서 타입을 좁힐 수 있다.</p>

<h3 id="typeof-연산자-비교">typeof 연산자 비교</h3>

<p>typeof 연산자는 하나의 인자를 받아 해당 인자의 타입을 문자열로 반환한다. 이를 통해 typeof 반환값과 문자열을 비교한 결과를 타입 가드로 사용할 수 있다.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">something</span><span class="p">(</span><span class="nx">data</span><span class="p">:</span> <span class="kr">string</span> <span class="o">|</span> <span class="kr">number</span> <span class="o">|</span> <span class="nx">boolean</span><span class="p">){</span>
  <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">data</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">string</span><span class="dl">'</span><span class="p">){</span>
    <span class="k">return</span> <span class="dl">'</span><span class="s1">string type</span><span class="dl">'</span>
  <span class="p">}</span>

  <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">data</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">number</span><span class="dl">'</span><span class="p">){</span>
    <span class="k">return</span> <span class="dl">'</span><span class="s1">string type</span><span class="dl">'</span>
  <span class="p">}</span>

  <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">data</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">boolean</span><span class="dl">'</span><span class="p">){</span>
    <span class="k">return</span> <span class="dl">'</span><span class="s1">string type</span><span class="dl">'</span>
  <span class="p">}</span>

  <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">'</span><span class="s1">string or number or boolean 이외의 타입이 들어왔습니다.</span><span class="dl">'</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">typeof</code> 연산자를 사용할 때는 프로그래머의 예상과 다르게 동작한다는 것을 주의해야한다. 흔히 사용되는 타입과 <code class="language-plaintext highlighter-rouge">typeof</code> 연산자의 반환값을 아래의 표로 확인해보자.</p>

<p>하위 호환성 이슈로 <code class="language-plaintext highlighter-rouge">typeof</code> <code class="language-plaintext highlighter-rouge">null</code>은 “null”이 아닌 “object”로 반환된다. 또한 <code class="language-plaintext highlighter-rouge">typeof</code> [] === “array”일 것이란 예상과 달리 배열을 나타내는 별도의 반환값이 존재하지 않는다.
이러한 혼란스러움으로 <code class="language-plaintext highlighter-rouge">typeof</code>로 타입 가드를 사용할 때는 <code class="language-plaintext highlighter-rouge">number</code>, <code class="language-plaintext highlighter-rouge">string</code>, <code class="language-plaintext highlighter-rouge">boolean</code>, <code class="language-plaintext highlighter-rouge">symbol</code>과 같이 단순한 타입에 대해서만 사용하는 것을 권장한다.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">타입</th>
      <th style="text-align: left">typeof 반환값</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Undefined</td>
      <td style="text-align: left">“undefined”</td>
    </tr>
    <tr>
      <td style="text-align: left">Null</td>
      <td style="text-align: left">“object”</td>
    </tr>
    <tr>
      <td style="text-align: left">Boolean</td>
      <td style="text-align: left">“boolean”</td>
    </tr>
    <tr>
      <td style="text-align: left">Number</td>
      <td style="text-align: left">“number”</td>
    </tr>
    <tr>
      <td style="text-align: left">String</td>
      <td style="text-align: left">“string”</td>
    </tr>
    <tr>
      <td style="text-align: left">Symbol</td>
      <td style="text-align: left">“symbol”</td>
    </tr>
    <tr>
      <td style="text-align: left">Function</td>
      <td style="text-align: left">“function”</td>
    </tr>
    <tr>
      <td style="text-align: left">그 외 모든 객체</td>
      <td style="text-align: left">“object”</td>
    </tr>
  </tbody>
</table>

<h3 id="instanceof-연산자-비교">instanceof 연산자 비교</h3>
<p><code class="language-plaintext highlighter-rouge">instanceof</code> 연산자는 값과 생성자를 받아 해당 값의 프로토타입 체인에 해당 생성자가 있는지 확인한다. ES6 클래스는 내부적으로 프로토타입 체인에 기반해 돌아가기 때문에, 클래스의 인스턴스 여부도 <code class="language-plaintext highlighter-rouge">instanceof</code>를 이용하여 타입 가드할 수 있다.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">interface</span> <span class="nx">Padder</span> <span class="p">{</span>
  <span class="nx">getPaddingString</span><span class="p">():</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">SpaceRepeatingPadder</span> <span class="k">implements</span> <span class="nx">Padder</span> <span class="p">{</span>
  <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">numSpaces</span><span class="p">:</span> <span class="kr">number</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

  <span class="nx">getPaddingString</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">Array</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">numSpaces</span> <span class="o">+</span> <span class="mi">1</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2"> </span><span class="dl">"</span><span class="p">);</span>

  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nx">StringPadder</span> <span class="k">implements</span> <span class="nx">Padder</span> <span class="p">{</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="k">private</span> <span class="nx">value</span><span class="p">:</span> <span class="kr">string</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>

  <span class="nx">getPaddingString</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>


<span class="kd">function</span> <span class="nx">getRandomPadder</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mf">0.5</span> <span class="p">?</span>
    <span class="k">new</span> <span class="nx">SpaceRepeatingPadder</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">new</span> <span class="nx">StringPadder</span><span class="p">(</span><span class="dl">"</span><span class="s2">  </span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>

<span class="err">​</span>
<span class="c1">// 이 시점에선 'SpaceRepeatingPadder | StringPadder'</span>
<span class="kd">let</span> <span class="nx">padder</span><span class="p">:</span> <span class="nx">Padder</span> <span class="o">=</span> <span class="nx">getRandomPadder</span><span class="p">();</span>


<span class="k">if</span> <span class="p">(</span><span class="nx">padder</span> <span class="k">instanceof</span> <span class="nx">SpaceRepeatingPadder</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">padder</span><span class="p">);</span> <span class="c1">// SpaceRepeatingPadder 로 좁혀짐</span>
<span class="p">}</span>

<span class="err">​</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">padder</span> <span class="k">instanceof</span> <span class="nx">StringPadder</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">padder</span><span class="p">);</span> <span class="c1">// StringPadder 로 좁혀짐</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="in-연산자-비교">in 연산자 비교</h3>
<p>in 연산자는 객체에 특정 속성이 존재하는지 여부를 판단하는데 사용한다.</p>

<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">interface</span> <span class="nx">Human</span> <span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">Animal</span> <span class="p">{</span>
  <span class="nl">age</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
<span class="p">}</span>


<span class="kd">type</span> <span class="nx">UnionType</span> <span class="o">=</span> <span class="nx">Human</span> <span class="o">|</span> <span class="nx">Animal</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">something</span><span class="p">(</span><span class="nx">data</span><span class="p">:</span> <span class="nx">UnionType</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="dl">'</span><span class="s1">name</span><span class="dl">'</span> <span class="k">in</span> <span class="nx">data</span><span class="p">){</span>
    <span class="c1">// Human Type</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
  <span class="p">}</span><span class="k">else</span><span class="p">{</span>
    <span class="c1">// Animal Type</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">age</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="사용자-정의-타입-가드">사용자 정의 타입 가드</h3>
<p>지금까지 타입스크립트 언어에 내장된 제어 흐름에 기반하여 동작하는 타입 가드를 살펴봤다. 이 뿐만 아니라 직접 임의의 기준을 사용해 타입 가드를 정의할 수 있는데 이것을 <code class="language-plaintext highlighter-rouge">사용자 정의 타입 가드</code>라 한다.
사용자 정의 타입 가드는 <code class="language-plaintext highlighter-rouge">value is Typ</code>e 형태로 반환 타입을 갖는 <code class="language-plaintext highlighter-rouge">함수</code>로 정의한다.</p>

<p>예를 들어, 위의 in연산자를 통해 타입가드를 사용했다면 특정 <code class="language-plaintext highlighter-rouge">Human</code> 타입인지 확인하는 <code class="language-plaintext highlighter-rouge">isHuman()</code> 함수로 대체할 수 있다.</p>
<div class="language-ts highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">interface</span> <span class="nx">Human</span> <span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="kr">interface</span> <span class="nx">Animal</span> <span class="p">{</span>
  <span class="nl">age</span><span class="p">:</span> <span class="kr">number</span><span class="p">;</span>
<span class="p">}</span>


<span class="kd">type</span> <span class="nx">UnionType</span> <span class="o">=</span> <span class="nx">Human</span> <span class="o">|</span> <span class="nx">Animal</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">isHuman</span><span class="p">(</span><span class="nx">data</span><span class="p">:</span> <span class="nx">UnionType</span><span class="p">):</span> <span class="nx">data</span> <span class="k">is</span> <span class="nx">Human</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span><span class="nx">data</span> <span class="k">as</span> <span class="nx">Human</span><span class="p">).</span><span class="nx">name</span> <span class="o">!==</span> <span class="kc">undefined</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">something</span><span class="p">(</span><span class="nx">data</span><span class="p">:</span> <span class="nx">UnionType</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">isHuman</span><span class="p">(</span><span class="nx">data</span><span class="p">)){</span>
    <span class="c1">// Human Type</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
  <span class="p">}</span><span class="k">else</span><span class="p">{</span>
    <span class="c1">// Animal Type</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">age</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>


<span class="nx">something</span><span class="p">({</span><span class="na">name</span><span class="p">:</span><span class="dl">'</span><span class="s1">siksik</span><span class="dl">'</span><span class="p">});</span>
<span class="nx">something</span><span class="p">({</span><span class="na">age</span><span class="p">:</span><span class="mi">10</span><span class="p">});</span>
</code></pre></div></div>


    </div>

</article>
<div class="post-nav">
<a class="previous" href="/javascript/2022/07/26/javascript-15.html" title="[Javascript] 화살표 함수의 this 바인딩">[Javascript] 화살표 함수의 this 바인딩</a><a class="next" href="/git/2022/08/10/git-11.html" title="[git] SSH로 여러 개의 Gitgub 계정 사용하기">[git] SSH로 여러 개의 Gitgub 계정...</a>
</div>
<div class="post-related">
      <div>Related Articles</div>
      <ul>
        <li><a class="post-link" href="/javascript/2021/12/08/javascript-02.html" title="[git] SSH로 여러 개의 Gitgub 계정 사용하기">[Javascript] ES2015(ES6) 표준 모듈 시스템 (export, import)</a></li>
<li><a class="post-link" href="/javascript/2022/04/14/javascript-13.html" title="[git] SSH로 여러 개의 Gitgub 계정 사용하기">[Javascript] 함수형 사고방식</a></li>
<li><a class="post-link" href="/nuxt.js/2022/03/23/nuxtJs-04.html" title="[git] SSH로 여러 개의 Gitgub 계정 사용하기">[Vue.js] Vuetify 그리드 시스템 (1) - 레이아웃</a></li>
<li><a class="post-link" href="/react/2022/04/21/react-02.html" title="[git] SSH로 여러 개의 Gitgub 계정 사용하기">[React] 라이프 사이클 메서드란?</a></li>
</ul>
    </div>
<div class="post-comments"></div></section>
</div>
<script>
  new Zooming().listen('img')
</script>

  </section>
  <section class="sidebar" style="margin-left: 15px;">
    <!-- Get sidebar items --><style type="text/css" media="screen">
.post-menu ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
</style>

<div class="post-menu">
  <div class="post-menu-title">TOC</div>
  <div class="post-menu-content"></div>
</div>

<script>
  function generateContent() {
    var menu = document.querySelector(".post-menu");
    var menuContent =  menu.querySelector(".post-menu-content");
    var headings = document.querySelector(".post-content").querySelectorAll("h2, h3, h4, h5, h6");

    // Hide menu when no headings
    if (headings.length === 0) {
      return menu.style.display = "none";
    }

    // Generate post menu
    var menuHTML = '';
    for (var i = 0; i < headings.length; i++) {
      var h = headings[i];
      menuHTML += (
        '<li class="h-' + h.tagName.toLowerCase() + '">'
        + '<a href="#h-' + h.getAttribute('id') + '">' + h.textContent + '</a></li>');
    }

    menuContent.innerHTML = '<ul>' + menuHTML + '</ul>';

    // The header element
    var header = document.querySelector('header.site-header');

    function doMenuCollapse(index, over_items) {
      var items = menuContent.firstChild.children;

      if (over_items == undefined) {
        over_items = 20;
      }

      if (items.length < over_items) {
        return;
      }

      var activeItem = items[index];
      var beginItem = activeItem
      var endItem = activeItem
      var beginIndex = index;
      var endIndex = index + 1;
      while (beginIndex >= 0
        && !items[beginIndex].classList.contains('h-h2')) {
        beginIndex -= 1;
      }
      while (endIndex < items.length
        && !items[endIndex].classList.contains('h-h2')) {
        endIndex += 1;
      }
      for (var i = 0; i < beginIndex; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
      for (var i = beginIndex + 1; i < endIndex; i++) {
        item = items[i]
        // if (!item.classList.contains('h-h2')) {
          item.style.display = '';
        // }
      }
      for (var i = endIndex; i < items.length; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
    }

    // Init menu collapsed
    doMenuCollapse(-1);

    // Active the menu item
    window.addEventListener('scroll', function (event) {
      var lastActive = menuContent.querySelector('.active');
      var changed = true;
      var activeIndex = -1;
      for (var i = headings.length - 1; i >= 0; i--) {
        var h = headings[i];
        var headingRect = h.getBoundingClientRect();
        var headerRect = header.getBoundingClientRect();
        var headerTop = Math.floor(headerRect.top);
        var headerHeight = Math.floor(headerRect.height);
        var headerHeight = headerTop + headerHeight + 20;
        if (headingRect.top <= headerHeight) {
          var id = 'h-' + h.getAttribute('id');
          var a = menuContent.querySelector('a[href="#' + id  + '"]');
          var curActive = a.parentNode;
          if (curActive) {
            curActive.classList.add('active');
            activeIndex = i;
          }
          if (lastActive == curActive) {
            changed = false;
          }
          break;
        }
      }
      if (changed) {
        if (lastActive) {
          lastActive.classList.remove('active');
        }
        doMenuCollapse(activeIndex);
      }
      event.preventDefault();
    });
  }
  generateContent();
</script>
</section>
</div>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <div class="site-footer-inner">
<div>
<span class="copyleft">©</span> 2022 Seo SeongSik. All rights reserved</div>
      <div>Go to <a title="github" href="https://github.com/s-seongsik">Github</a>
</div>
    </div>
  </div>
</footer>
</body>
</html>
